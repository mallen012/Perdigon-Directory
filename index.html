
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Perdigon Directory</title>
  <style>
    body { font-family: Montserrat, Arial, sans-serif; background: #23272e; color: #f3f3fa; margin: 0; }
    .top-banner { display:flex; align-items:center; justify-content:space-between; background:#181a1f; padding:10px 18px; min-height:64px; flex-wrap:wrap; }
    .banner-left { display:flex; align-items:center; gap:16px; }
    .banner-logo { height:40px; border-radius:8px; filter:drop-shadow(0 2px 6px #0005); }
    .banner-title { font-size:1.6em; font-weight:700; color:#fff; letter-spacing:.01em; }
    .banner-date  { color:#ccd; font-size:1.04em; margin-left:18px; }
    .weather-bar { display:flex; gap:14px; align-items:center; margin-left:26px; color:#ffd700; }
    .weather-bar-city { display:inline-block; background:#202538; border-radius:11px; padding:8px 14px; box-shadow:0 2px 8px #0003; min-width:172px; cursor:pointer; transition:box-shadow .2s; }
    .weather-bar-city:hover { box-shadow:0 2px 16px #06b3e6b0; }
    .weather-bar-cityname { font-weight:700; color:#ffe066; font-size:1.08em; }
    .weather-bar-main     { font-size:1.05em; font-weight:600; margin-left:8px; }
    .weather-bar-desc     { color:#dbeafe; font-size:.95em; margin-left:7px; }
    .weather-bar-hi       { color:#ffd700; font-size:.96em; margin-right:6px; }
    .weather-bar-lo       { color:#8ee7ff; font-size:.96em; }
    .weather-bar-forecast { margin-top:2px; display:flex; gap:7px; justify-content:center; }
    .weather-bar-fc       { text-align:center; }
    .weather-bar-fc-day   { font-size:.95em; color:#ffe066; font-weight:600; }
    .weather-bar-fc-desc  { font-size:.92em; color:#b3e2ff; }
    .main-content   { display:flex; gap:32px; justify-content:center; align-items:flex-start; max-width:1500px; margin:28px auto 0; }
    .directory-section { flex:2 1 0; min-width:310px; }
    .agenda-section { flex:1 1 0; min-width:340px; max-width:480px; }
    .section-title  { font-size:1.13em; color:#b6caff; font-weight:700; margin:12px 0 8px 4px; }
    table { border-collapse:collapse; width:100%; background:#292e36; border-radius:16px; overflow:hidden; box-shadow:0 4px 16px #1115; margin-bottom:14px; }
    th, td { padding:10px 7px; border:1px solid #444c; text-align:left; }
    th { background:#222844; color:#fff; font-weight:700; font-size:1em; }
    td.number a { color:#99d3ff; font-weight:700; text-decoration:underline; }
    td.email { text-align:center; }
    .envelope-icon { width:21px; height:21px; vertical-align:middle; filter:drop-shadow(0 1px 4px #0006); }
    .footer { text-align:center; font-size:small; color:#888; margin-top:32px; padding-bottom:20px; }

    .agenda-widget { background:#292e36; border-radius:12px; box-shadow:0 2px 10px #0002; margin-bottom:24px; }
    .agenda-day    { background:#23272e; color:#ffd900; padding:8px 14px; cursor:pointer; font-size:1.08em; border-bottom:1px solid #323650; }
    .agenda-list   { padding:6px 14px 8px 18px; }
    .agenda-event  { display:flex; align-items:center; gap:8px; padding:4px 0 6px; }
    .agenda-time   { font-weight:bold; color:#47c7ef; width:67px; }
    .agenda-title  { flex:1; }
    .agenda-join   { margin-left:14px; background:#28c66f; color:#fff; padding:6px 18px; border-radius:6px; text-decoration:none; font-weight:700; font-size:.99em; }
    .agenda-join:hover { background:#249854; }

    .searchbar { margin:11px 0 17px; text-align:right; }
    .searchbar input { font-size:1em; padding:7px 13px; border-radius:7px; border:1px solid #bbb; background:#23272e; color:#fff; }

    .dept-header-row td { background:linear-gradient(90deg,#31418f 80%,#222844 120%); color:#fff; font-weight:700; font-size:1.10em; padding:15px 14px 8px; border-top:3px solid #4f46e5; border-bottom:2px solid #3c3c60; }
    .dept-space td      { border:none!important; height:5px; background:transparent; padding:0; }

    .custom-widget { background:#232d39; border-radius:12px; box-shadow:0 2px 8px #0002; padding:18px; margin-top:22px; text-align:center; color:#ffe066; }
    .custom-widget span{ font-size:1.1em; font-weight:700; color:#ffd700; }

    .quicklinks { margin-top:10px; }
    .quicklinks a { display:inline-block; margin:6px 6px 0 0; padding:8px 18px; border-radius:7px; text-decoration:none; font-weight:500; }
    .quicklinks a.duo     { background:#28c66f; color:#fff; }
    .quicklinks a.tac     { background:#1185c2; color:#fff; }
    .quicklinks a.perdigon{ background:#e6b400; color:#23272e; }
    .quicklinks a.kb      { background:#fa8c28; color:#fff; }
    .quicklinks a.help    { background:#0cb1e7; color:#fff; }
    .quicklinks a:hover   { box-shadow:0 0 12px #3338; }

    /* ==== Cloud Service Status widget ==== */
    .status-widget { background:#232d39; border-radius:12px; padding:18px; margin-top:22px; color:#fff; }
    .status-title  { font-size:1.1em; font-weight:700; color:#ffd700; margin-bottom:12px; }
    .status-list   { list-style:none; padding:0; margin:0; }
    .status-list li{ display:flex; align-items:center; margin:6px 0; }
    .status-dot    { width:10px; height:10px; border-radius:50%; margin-right:8px; }
    .status-item   { display:flex; justify-content:space-between; flex:1; }
    .status-link   { display:inline-block; margin-top:10px; color:#ffd700; font-weight:600; text-decoration:none; }
    .status-link:hover { text-decoration:underline; }

    @media (max-width:1050px) {
      .main-content{ flex-direction:column; align-items:stretch; gap:0; }
      .agenda-section{ max-width:100%; min-width:unset; margin-top:28px; }
    }
  </style>
</head>
<body>
  <div class="top-banner">
    <div class="banner-left">
      <img class="banner-logo"
           src="https://mallen012.github.io/Perdigon-Directory/Blue%20Logo.png"
           alt="Perdigon Logo" onerror="this.style.display='none'">
      <span class="banner-title">Perdigon Directory</span>
      <span class="banner-date" id="banner-date"></span>
    </div>
    <div class="weather-bar" id="weather-bar">Loading weather?</div>
  </div>

  <div class="main-content">
    <div class="directory-section">
      <div class="searchbar">
        <input id="directory-search"
               placeholder="Search directory?"
               oninput="filterDirectory()">
      </div>

      <table id="directory-table">
        <tr>
          <th>Name</th><th>Department</th><th>Number</th><th></th><th>Notes</th>
        </tr><tr class="dept-header-row"><td colspan="5">Vendor</td></tr><tr class="contact-row"><td>ZoHo Support</td><td>Vendor</td><td class="number"><a href="tel:888-900-9646">888-900-9646</a></td><td class="email"></td><td>Option 2, Option 2</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Service</td></tr><tr class="contact-row"><td>Perdigon Service Dept</td><td>Service</td><td class="number"><a href="tel:435-777-7811">435-777-7811</a></td><td class="email"><a href="mailto:support@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Option 1 or ext 7812</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">*Perdi Sales</td></tr><tr class="contact-row"><td>*Mike Allen Cell</td><td>*Perdi Sales</td><td class="number"><a href="tel:530-933-6253">530-933-6253</a></td><td class="email"><a href="mailto:mike@perdi.net" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Mike Cell</td></tr><tr class="contact-row"><td>Mike Allen Video</td><td>*Perdi Sales</td><td class="number"><a href="tel:mike.allen@perdigon-group.com">mike.allen@perdigon-group.com</a></td><td class="email"><a href="mailto:mike.allen@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Mike Video</td></tr><tr class="contact-row"><td>*Erik Peterson Cell</td><td>*Perdi Sales</td><td class="number"><a href="tel:801-903-3033">801-903-3033</a></td><td class="email"><a href="mailto:erik@perdi.net" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Erik Cell</td></tr><tr class="contact-row"><td>Luke Allen</td><td>*Perdi Sales</td><td class="number"><a href="tel:916-295-8312">916-295-8312</a></td><td class="email"><a href="mailto:luke.allen@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Luke Allen</td></tr><tr class="contact-row"><td>*Mike PMR</td><td>*Perdi Sales</td><td class="number"><a href="tel:mike.allen.perdigon@webex.com">mike.allen.perdigon@webex.com</a></td><td class="email"></td><td>Join from Device</td></tr><tr class="contact-row"><td>*Erik PMR</td><td>*Perdi Sales</td><td class="number"><a href="tel:erik.perdigon@webex.com">erik.perdigon@webex.com</a></td><td class="email"><a href="mailto:erik@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Join from Device</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Support</td></tr><tr class="contact-row"><td>Cisco TAC</td><td>Support</td><td class="number"><a href="tel:1-800-553-2447">1-800-553-2447</a></td><td class="email"></td><td>Also open online: here</td></tr><tr class="contact-row"><td>Webex Partner Help Desk</td><td>Support</td><td class="number"><a href="tel:1-844-613-6108">1-844-613-6108</a></td><td class="email"></td><td></td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Testing</td></tr><tr class="contact-row"><td>Mike Allen DialPad</td><td>Testing</td><td class="number"><a href="tel:(916) 312-3122">(916) 312-3122</a></td><td class="email"></td><td>DialPad DID</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">*Perdi HR</td></tr><tr class="contact-row"><td>Andie Peterson</td><td>*Perdi HR</td><td class="number"><a href="tel:801-473-6696">801-473-6696</a></td><td class="email"></td><td>Cell</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">*Perdi Sales</td></tr><tr class="contact-row"><td>*Erik Peterson Perdi Line</td><td>*Perdi Sales</td><td class="number"><a href="tel:435-777-7750">435-777-7750</a></td><td class="email"></td><td>Sales Leader</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Quest</td></tr><tr class="contact-row"><td>Adam Burke </td><td>Quest</td><td class="number"><a href="tel:916-609-8049">916-609-8049</a></td><td class="email"><a href="mailto:adam_burke@questsys.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Dave Noel</td><td>Quest</td><td class="number"><a href="tel:916-634-7687">916-634-7687</a></td><td class="email"><a href="mailto:David_Noel@questsys.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Partner Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Lenovo</td></tr><tr class="contact-row"><td>Ashley Durham</td><td>Lenovo</td><td class="number"><a href="tel:(919) 874-3296">(919) 874-3296</a></td><td class="email"><a href="mailto:adurham1@lenovo.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>SMB Sales Rep</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">*Perdi Sales</td></tr><tr class="contact-row"><td>Luke Villareal</td><td>*Perdi Sales</td><td class="number"><a href="tel:435-275-8498">435-275-8498</a></td><td class="email"><a href="mailto:luke.villareal@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Senior Account Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Bucher-Suter</td></tr><tr class="contact-row"><td>Martin Wuthrich </td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Martin.Wuethrich@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>CEO</td></tr><tr class="contact-row"><td>Kenny Barton</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Kenny.Barton@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Garrich Theisen</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Garrich.Theisen@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>CSM</td></tr><tr class="contact-row"><td>Chris Bourque</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Christopher.Bourque@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Dave Nichols </td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:David.Nichols@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Account Executive</td></tr><tr class="contact-row"><td>Dustin Gregoire</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Dustin.Gregoire@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Account Executive</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Vonage</td></tr><tr class="contact-row"><td>Nathan Schexnayder</td><td>Vonage</td><td class="number"><a href="tel:480-289-7513">480-289-7513</a></td><td class="email"><a href="mailto:nathan.schexnayder@vonage.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Channel Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Content Guru</td></tr><tr class="contact-row"><td>Riad Itani</td><td>Content Guru</td><td class="number"></td><td class="email"><a href="mailto:RII@contentguru.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Channel Account Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Dialpad</td></tr><tr class="contact-row"><td>Jason Rothrock</td><td>Dialpad</td><td class="number"><a href="tel:(303) 385-8052">(303) 385-8052</a></td><td class="email"><a href="mailto:jason.rothrock@dialpad.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Partner Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Baker Tilly</td></tr><tr class="contact-row"><td>Kristie Liang</td><td>Baker Tilly</td><td class="number"></td><td class="email"><a href="mailto:Kristie.Liang@bakertilly.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Managed Services ? Accounting and Finance</td></tr><tr class="contact-row"><td>Jessy Kubal</td><td>Baker Tilly</td><td class="number"><a href="tel:(408) 558-7512">(408) 558-7512</a></td><td class="email"><a href="mailto:Jessy.Kubal@bakertilly.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Managing Director</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Intelepeer</td></tr><tr class="contact-row"><td>Vickie McGovern</td><td>Intelepeer</td><td class="number"></td><td class="email"><a href="mailto:vmcgovern@intelepeer.ai " title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Strategic Partnerships</td></tr><tr class="contact-row"><td>Jim Pallotto</td><td>Intelepeer</td><td class="number"></td><td class="email"><a href="mailto:jpallotto@intelepeer.ai" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Sr. Director of Customer Success</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Cisco</td></tr><tr class="contact-row"><td>Kyle Decker</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:kyldecke@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Ryan Poulos</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:rpoulos@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Cisco </td></tr><tr class="contact-row"><td>Angie Mann</td><td>Cisco </td><td class="number"></td><td class="email"><a href="mailto:angmann@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Cisco</td></tr><tr class="contact-row"><td>Austin Estrada</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:auestrad@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Brandon Viamonte</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:bviamont@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Michelle Heiden </td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:mheiden@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Mike Woods</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:miwoods2@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Tom Amery</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:tamery@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Sarah Reuter</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:sareuter@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Stephanie Marcq</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:smarcq@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Ryan Wu</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:ryawu@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Hogler Forrest</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:hoforres@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Aleks Wittemann</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:awittema@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Shannon Rife</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:shmcbrid@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Dennis Trop</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:dtrop@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Alex Trop</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:atrop@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Eamon Attarzadeh</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:eattarza@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Territory Account Manager</td></tr><tr class="contact-row"><td>Howard Shannahan </td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:hshanaha@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Corey Freeze</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:cfreeze@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Partner Account Manager</td></tr><tr class="contact-row"><td>Kendal Oram</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:koram@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Security AE</td></tr><tr class="contact-row"><td>Julianne Aitken</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:juaitken@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr>
      </table>
      <div class="footer">Generated by Perdigon | &copy; Mike Allen</div>
    </div>

    <div class="agenda-section">
      <div class="section-title">Support Calendar</div>
      <div id="agenda-widget" class="agenda-widget">Loading calendar?</div>

      <div class="custom-widget">
        <span>Quick Links</span>
        <div class="quicklinks">
          <a href="https://perdigon.webex.com"    target="_blank">Webex Room</a>
          <a href="https://support.perdigon-group.com/" class="tac" target="_blank">Submit Ticket</a>
          <a href="https://perdigon-group.com"     class="perdigon" target="_blank">Company Website</a>
          <a href="https://mycase.cloudapps.cisco.com/start?referring_site=wwcontacts"
             class="tac" target="_blank">Open TAC Case</a>
        </div>
      </div>

      <div class="status-widget">
        <div class="status-title">Cloud Service Status</div>
        <ul id="status-list" class="status-list">
          <li>Loading?</li>
        </ul>
        <a href="https://status.webex.com" class="status-link" target="_blank">
          All Webex Services ?
        </a>
      </div>
    </div>
  </div>

  <script>
    // ? Banner Date ?
    function updateBannerDate(){
      var now = new Date();
      document.getElementById("banner-date").textContent =
        now.toLocaleString("en-US", {
          weekday:"short", month:"short", day:"2-digit", year:"numeric",
          hour:"numeric", minute:"2-digit"
        });
    }
    updateBannerDate();
    setInterval(updateBannerDate,15000);

    // ? Weather Logic ?
    var weatherCities = [
      {zip:"95648", city:"Lincoln, CA", wu:"https://www.wunderground.com/weather/us/ca/lincoln/95648"},
      {zip:"84664", city:"Mapleton, UT", wu:"https://www.wunderground.com/weather/us/ut/mapleton/84664"}
    ];
    function iconSvg(icon){
      var map = {
        "01d":"day-sunny","01n":"night-clear",
        "02d":"day-cloudy","02n":"night-alt-cloudy",
        "03d":"cloudy","03n":"cloudy",
        "04d":"cloudy","04n":"cloudy",
        "09d":"showers","09n":"showers",
        "10d":"rain","10n":"rain",
        "11d":"thunderstorm","11n":"thunderstorm",
        "13d":"snow","13n":"snow",
        "50d":"fog","50n":"fog"
      };
      var f = map[icon]||"cloudy";
      return '<img src="animated/'+f+'.svg" width="33" height="33" style="vertical-align:middle;filter:drop-shadow(0 2px 6px #0003)">';
    }
    function getForecastParts(forecast){
      var out=[], seen={};
      forecast.list.forEach(function(pt){
        var d = new Date(pt.dt_txt);
        if (d.getHours()===12 && !seen[d.getDate()]) {
          out.push(pt);
          seen[d.getDate()]=true;
        }
      });
      return out.slice(0,3);
    }
    function updateWeatherBar(){
      var bar = document.getElementById("weather-bar");
      bar.textContent = "Loading weather?";
      Promise.all(weatherCities.map(function(c){
        var base = "https://api.openweathermap.org/data/2.5";
        var wURL = base + "/weather?zip=" + c.zip
                 + "&appid=65debdc01963a542cfdad42c57f624ad"
                 + "&units=imperial";
        var fURL = base + "/forecast?zip=" + c.zip
                 + "&appid=65debdc01963a542cfdad42c57f624ad"
                 + "&units=imperial";
        return Promise.all([wURL, fURL].map(function(u){
          return fetch(u).then(function(r){
            if (!r.ok) throw new Error("HTTP " + r.status);
            return r.json();
          });
        }));
      }))
      .then(function(all){
        bar.innerHTML = all.map(function(pair,i){
          var w = pair[0], f = getForecastParts(pair[1]), city = weatherCities[i];
          var main = Math.round(w.main.temp) + "?F",
              hi   = Math.round(w.main.temp_max) + "?",
              lo   = Math.round(w.main.temp_min) + "?",
              desc = w.weather[0].main,
              icon = w.weather[0].icon;
          var fcHtml = "";
          if (f.length) {
            fcHtml = '<div class="weather-bar-forecast">' +
              f.map(function(pt){
                var d = new Date(pt.dt_txt),
                    day = d.toLocaleString("en-US",{weekday:"short"}),
                    file = (iconSvg(pt.weather[0].icon).match(/animated\/([^\.]+)\./)||[])[1]||"cloudy";
                return '<div class="weather-bar-fc">'
                  + '<div class="weather-bar-fc-day">' + day + '</div>'
                  + '<img src="animated/' + file + '.svg" width="21" height="21">'
                  + '<div class="weather-bar-fc-desc">' + pt.weather[0].main + '</div>'
                  + '<span class="weather-bar-hi">' + Math.round(pt.main.temp_max) + '?</span>'
                  + '<span class="weather-bar-lo">' + Math.round(pt.main.temp_min) + '?</span>'
                  + '</div>';
              }).join("") +
              '</div>';
          }
          return '<div class="weather-bar-city" onclick="window.open('' + city.wu + '','_blank')">'
            + '<div class="weather-bar-cityname">' + city.city + '</div>'
            + iconSvg(icon)
            + '<span class="weather-bar-main">' + main + '</span>'
            + '<span class="weather-bar-desc">' + desc + '</span><br>'
            + '<span class="weather-bar-hi">H: ' + hi + '</span>'
            + '<span class="weather-bar-lo">L: ' + lo + '</span>'
            + fcHtml
            + '</div>';
        }).join("");
      })
      .catch(function(e){
        console.error("Weather error:", e);
        bar.innerHTML = '<span style="color:#f44;">Weather unavailable</span>';
      });
    }
    document.addEventListener("DOMContentLoaded", updateWeatherBar);

    // ? Calendar Agenda ?
    function fetchCalendarAgenda(){
      var widget = document.getElementById("agenda-widget");
      var now    = new Date();
      var timeMin= new Date(now.getFullYear(),now.getMonth(),now.getDate()).toISOString();
      var timeMax= new Date(now.getFullYear(),now.getMonth(),now.getDate()+2).toISOString();
      var url = "https://www.googleapis.com/calendar/v3/calendars/"
              + encodeURIComponent("support@perdigon-group.com")
              + "/events?key=" + "AIzaSyDqMNGC5RUnlzSxP3vbD8WKzt_qPfUzab0"
              + "&singleEvents=true&orderBy=startTime"
              + "&timeMin=" + encodeURIComponent(timeMin)
              + "&timeMax=" + encodeURIComponent(timeMax)
              + "&maxResults=20";
      fetch(url)
        .then(function(r){
          if(!r.ok) throw new Error("HTTP "+r.status);
          return r.json();
        })
        .then(function(data){
          var A = { today:[], tomorrow:[] };
          var today = timeMin.slice(0,10);
          var tomDt = new Date(timeMin); tomDt.setDate(tomDt.getDate()+1);
          var tomorrow = tomDt.toISOString().slice(0,10);
          (data.items||[]).forEach(function(ev){
            var s = ev.start.dateTime||ev.start.date;
            if(!s) return;
            var d = s.slice(0,10),
                grp = d===today ? "today" : d===tomorrow ? "tomorrow" : null;
            if(!grp) return;
            var t = ev.start.dateTime
                  ? new Date(ev.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})
                  : "",
                jl = (ev.description && ev.description.match(/https?://[^s<]+/))?.[0] || "";
            A[grp].push({title:ev.summary||"",time:t,join:jl});
          });
          widget.innerHTML = ["today","tomorrow"].map(function(day){
            var list = A[day];
            var out  = '<div class="agenda-day" onclick="toggleAgenda(''+day+'')">'
                     + '<strong>'+day.charAt(0).toUpperCase()+day.slice(1)+'</strong></div>'
                     + '<div class="agenda-list" id="agenda-'+day+'" style="display:none;">';
            if(list.length){
              list.forEach(function(e){
                out += '<div class="agenda-event">'
                    + '<span class="agenda-time">'+e.time+'</span>'
                    + '<span class="agenda-title">'+e.title+'</span>'
                    + (e.join?'<a href="'+e.join+'" target="_blank" class="agenda-join">Join Meeting</a>':"")
                    + '</div>';
              });
            } else {
              out += "<div class='agenda-empty'>No events</div>";
            }
            out += "</div>";
            return out;
          }).join("");
        })
        .catch(function(e){
          console.error("Calendar error:", e);
          widget.innerHTML = "<div style='color:#f44;'>Calendar unavailable</div>";
        });
    }
    document.addEventListener("DOMContentLoaded", fetchCalendarAgenda);
    function toggleAgenda(day){
      var e = document.getElementById("agenda-"+day);
      e.style.display = (e.style.display==="none"?"block":"none");
    }

    // ? Directory Filter ?
    function filterDirectory(){
      var f = document.getElementById("directory-search").value.toLowerCase();
      document.querySelectorAll("#directory-table tr.contact-row").forEach(function(r){
        r.style.display = r.textContent.toLowerCase().includes(f) ? "" : "none";
      });
      document.querySelectorAll("#directory-table tr.dept-header-row").forEach(function(h){
        var any=false, nxt=h.nextElementSibling;
        while(nxt && !nxt.classList.contains("dept-header-row")){
          if(nxt.classList.contains("contact-row") && nxt.style.display!=="none"){
            any=true; break;
          }
          nxt = nxt.nextElementSibling;
        }
        h.style.display = any ? "" : "none";
        var sp = h.nextElementSibling;
        if(sp && sp.classList.contains("dept-space")){
          sp.style.display = any ? "" : "none";
        }
      });
    }

    // ? Cloud Service Status ?
    function appendStatus(ul,name,label,indicator){
      var colors = {
        operational:"#28c66f", minor:"#ffd500",
        degraded_performance:"#ffd500",
        major:"#d93f3f", critical:"#d93f3f"
      };
      var dot = document.createElement("span");
      dot.className="status-dot";
      dot.style.background = colors[indicator] || "#888";
      var item = document.createElement("div");
      item.className="status-item";
      item.innerHTML = "<span>"+name+"</span><strong>"+label+"</strong>";
      var li = document.createElement("li");
      li.appendChild(dot);
      li.appendChild(item);
      ul.appendChild(li);
    }
    function updateCloudStatus(){
      var ul = document.getElementById("status-list");
      ul.innerHTML="";
      // Webex
      fetch("https://status.webex.com/summary.json")
        .then(r=>r.json())
        .then(function(d){
          ["Webex Calling","Webex App","Webex Control Hub","Webex Meetings","Webex Contact Center"]
          .forEach(function(name){
            var c = d.components.find(x=>x.name===name);
            if(c) appendStatus(ul,name,
              c.status.charAt(0).toUpperCase()+c.status.slice(1),
              c.status);
          });
        })
        .catch(e=>console.error("Webex status error:",e));
      // ChatGPT
      fetch("https://status.openai.com/api/v2/status.json")
        .then(r=>r.json())
        .then(function(d){
          var ind = d.status.indicator,
              map = { none:"Operational", minor:"Notice", major:"Partial Outage", critical:"Major Outage" };
          appendStatus(ul,"ChatGPT Status", map[ind]||ind, ind);
        })
        .catch(e=>{ console.error("OpenAI status error:",e);
          appendStatus(ul,"ChatGPT Status","Unknown","critical");
        });
    }
    document.addEventListener("DOMContentLoaded", updateCloudStatus);
  </script>
</body>
</html>