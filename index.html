
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Perdigon Directory</title>
  <style>
    /* --- your existing CSS here (unchanged) --- */
  </style>
</head>
<body>
  <div class="top-banner">
    <div class="banner-left">
      <img class="banner-logo"
           src="https://mallen012.github.io/Perdigon-Directory/Blue%20Logo.png"
           alt="Perdigon Logo" onerror="this.style.display='none';">
      <span class="banner-title">Perdigon Directory</span>
      <span class="banner-date" id="banner-date"></span>
    </div>
    <div class="weather-bar" id="weather-bar">Loading weather?</div>
  </div>

  <div class="main-content">
    <div class="directory-section">
      <div class="searchbar">
        <input id="directory-search"
               placeholder="Search directory..."
               oninput="filterDirectory()">
      </div>
      <table id="directory-table">
        <tr>
          <th>Name</th><th>Department</th><th>Number</th><th></th><th>Notes</th>
        </tr>
        <tr class="dept-header-row"><td colspan="5">*Perdi HR</td></tr><tr class="contact-row"><td>Andie Peterson</td><td>*Perdi HR</td><td class="number"><a href="tel:801-473-6696">801-473-6696</a></td><td class="email"></td><td>Cell</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">*Perdi Sales</td></tr><tr class="contact-row"><td>*Erik Peterson Cell</td><td>*Perdi Sales</td><td class="number"><a href="tel:801-903-3033">801-903-3033</a></td><td class="email"><a href="mailto:erik@perdi.net" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Erik Cell</td></tr><tr class="contact-row"><td>*Erik Peterson Perdi Line</td><td>*Perdi Sales</td><td class="number"><a href="tel:435-777-7750">435-777-7750</a></td><td class="email"></td><td>Sales Leader</td></tr><tr class="contact-row"><td>*Erik PMR</td><td>*Perdi Sales</td><td class="number"><a href="tel:erik.perdigon@webex.com">erik.perdigon@webex.com</a></td><td class="email"><a href="mailto:erik@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Join from Device</td></tr><tr class="contact-row"><td>*Mike Allen Cell</td><td>*Perdi Sales</td><td class="number"><a href="tel:530-933-6253">530-933-6253</a></td><td class="email"><a href="mailto:mike@perdi.net" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Mike Cell</td></tr><tr class="contact-row"><td>*Mike PMR</td><td>*Perdi Sales</td><td class="number"><a href="tel:mike.allen.perdigon@webex.com">mike.allen.perdigon@webex.com</a></td><td class="email"></td><td>Join from Device</td></tr><tr class="contact-row"><td>Luke Allen</td><td>*Perdi Sales</td><td class="number"><a href="tel:916-295-8312">916-295-8312</a></td><td class="email"><a href="mailto:luke.allen@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Luke Allen</td></tr><tr class="contact-row"><td>Luke Villareal</td><td>*Perdi Sales</td><td class="number"><a href="tel:435-275-8498">435-275-8498</a></td><td class="email"><a href="mailto:luke.villareal@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Senior Account Manager</td></tr><tr class="contact-row"><td>Mike Allen Video</td><td>*Perdi Sales</td><td class="number"><a href="tel:mike.allen@perdigon-group.com">mike.allen@perdigon-group.com</a></td><td class="email"><a href="mailto:mike.allen@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Mike Video</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Baker Tilly</td></tr><tr class="contact-row"><td>Jessy Kubal</td><td>Baker Tilly</td><td class="number"><a href="tel:(408) 558-7512">(408) 558-7512</a></td><td class="email"><a href="mailto:Jessy.Kubal@bakertilly.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Managing Director</td></tr><tr class="contact-row"><td>Kristie Liang</td><td>Baker Tilly</td><td class="number"></td><td class="email"><a href="mailto:Kristie.Liang@bakertilly.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Managed Services ? Accounting and Finance</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Bucher-Suter</td></tr><tr class="contact-row"><td>Chris Bourque</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Christopher.Bourque@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Dave Nichols </td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:David.Nichols@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Account Executive</td></tr><tr class="contact-row"><td>Dustin Gregoire</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Dustin.Gregoire@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Account Executive</td></tr><tr class="contact-row"><td>Garrich Theisen</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Garrich.Theisen@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>CSM</td></tr><tr class="contact-row"><td>Kenny Barton</td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Kenny.Barton@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Martin Wuthrich </td><td>Bucher-Suter</td><td class="number"></td><td class="email"><a href="mailto:Martin.Wuethrich@bucher-suter.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>CEO</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Cisco</td></tr><tr class="contact-row"><td>Aleks Wittemann</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:awittema@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Alex Trop</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:atrop@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Austin Estrada</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:auestrad@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Brandon Viamonte</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:bviamont@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Corey Freeze</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:cfreeze@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Partner Account Manager</td></tr><tr class="contact-row"><td>Dennis Trop</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:dtrop@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Eamon Attarzadeh</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:eattarza@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Territory Account Manager</td></tr><tr class="contact-row"><td>Hogler Forrest</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:hoforres@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Howard Shannahan </td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:hshanaha@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Julianne Aitken</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:juaitken@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Kendal Oram</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:koram@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Security AE</td></tr><tr class="contact-row"><td>Kyle Decker</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:kyldecke@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Michelle Heiden </td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:mheiden@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Mike Woods</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:miwoods2@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Ryan Poulos</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:rpoulos@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Ryan Wu</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:ryawu@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Sarah Reuter</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:sareuter@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Shannon Rife</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:shmcbrid@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Manager</td></tr><tr class="contact-row"><td>Stephanie Marcq</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:smarcq@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="contact-row"><td>Tom Amery</td><td>Cisco</td><td class="number"></td><td class="email"><a href="mailto:tamery@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Cisco </td></tr><tr class="contact-row"><td>Angie Mann</td><td>Cisco </td><td class="number"></td><td class="email"><a href="mailto:angmann@cisco.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Collab AE</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Content Guru</td></tr><tr class="contact-row"><td>Riad Itani</td><td>Content Guru</td><td class="number"></td><td class="email"><a href="mailto:RII@contentguru.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Channel Account Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Dialpad</td></tr><tr class="contact-row"><td>Jason Rothrock</td><td>Dialpad</td><td class="number"><a href="tel:(303) 385-8052">(303) 385-8052</a></td><td class="email"><a href="mailto:jason.rothrock@dialpad.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Partner Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Intelepeer</td></tr><tr class="contact-row"><td>Jim Pallotto</td><td>Intelepeer</td><td class="number"></td><td class="email"><a href="mailto:jpallotto@intelepeer.ai" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Sr. Director of Customer Success</td></tr><tr class="contact-row"><td>Vickie McGovern</td><td>Intelepeer</td><td class="number"></td><td class="email"><a href="mailto:vmcgovern@intelepeer.ai " title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Strategic Partnerships</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Lenovo</td></tr><tr class="contact-row"><td>Ashley Durham</td><td>Lenovo</td><td class="number"><a href="tel:(919) 874-3296">(919) 874-3296</a></td><td class="email"><a href="mailto:adurham1@lenovo.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>SMB Sales Rep</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Quest</td></tr><tr class="contact-row"><td>Adam Burke </td><td>Quest</td><td class="number"><a href="tel:916-609-8049">916-609-8049</a></td><td class="email"><a href="mailto:adam_burke@questsys.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>VP of Sales</td></tr><tr class="contact-row"><td>Dave Noel</td><td>Quest</td><td class="number"><a href="tel:916-634-7687">916-634-7687</a></td><td class="email"><a href="mailto:David_Noel@questsys.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Partner Manager</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Service</td></tr><tr class="contact-row"><td>Perdigon Service Dept</td><td>Service</td><td class="number"><a href="tel:435-777-7811">435-777-7811</a></td><td class="email"><a href="mailto:support@perdigon-group.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Option 1 or ext 7812</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Support</td></tr><tr class="contact-row"><td>Cisco TAC</td><td>Support</td><td class="number"><a href="tel:1-800-553-2447">1-800-553-2447</a></td><td class="email"></td><td>Also open online: here</td></tr><tr class="contact-row"><td>Webex Partner Help Desk</td><td>Support</td><td class="number"><a href="tel:1-844-613-6108">1-844-613-6108</a></td><td class="email"></td><td></td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Testing</td></tr><tr class="contact-row"><td>Mike Allen DialPad</td><td>Testing</td><td class="number"><a href="tel:(916) 312-3122">(916) 312-3122</a></td><td class="email"></td><td>DialPad DID</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Vendor</td></tr><tr class="contact-row"><td>ZoHo Support</td><td>Vendor</td><td class="number"><a href="tel:888-900-9646">888-900-9646</a></td><td class="email"></td><td>Option 2, Option 2</td></tr><tr class="dept-space"><td colspan="5"></td></tr><tr class="dept-header-row"><td colspan="5">Vonage</td></tr><tr class="contact-row"><td>Nathan Schexnayder</td><td>Vonage</td><td class="number"><a href="tel:480-289-7513">480-289-7513</a></td><td class="email"><a href="mailto:nathan.schexnayder@vonage.com" title="Send email"><img src="animated/envelope.svg" class="envelope-icon"></a></td><td>Regional Channel Manager</td></tr>
      </table>
      <div class="footer">Generated by Perdigon | ? Mike Allen</div>
    </div>

    <div class="agenda-section">
      <div class="section-title">Support Calendar</div>
      <div id="agenda-widget" class="agenda-widget">Loading calendar?</div>
      <div class="custom-widget">
        <span>Quick Links</span>
        <div class="quicklinks">
          <a href="https://perdigon.webex.com"    target="_blank">Perdi Webex Site</a>
          <a href="https://support.perdigon-group.com/" class="tac"    target="_blank">Perdi Submit Ticket</a>
          <a href="https://perdigon-group.com"     class="perdigon" target="_blank">Perdigon Website</a>
          <a href="https://mycase.cloudapps.cisco.com/start?referring_site=wwcontacts" class="tac" target="_blank">Open TAC Case</a>
          <a href="https://perdigon.login.duosecurity.com/central/" class="duo" target="_blank">Perdi Duo Central</a>
          <a href="https://help.webex.com/en-us/contact" class="help" target="_blank">Webex HelpDesk</a>
          <a href="https://help.webex.com/en-us/result?offset=10&tab=support" class="kb" target="_blank">Webex KB</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    //?? Banner Date ??
    function updateBannerDate() {
      var now = new Date();
      var s = now.toLocaleString("en-US", {
        weekday: "short", month: "short", day: "2-digit", year: "numeric",
        hour: "numeric", minute: "2-digit"
      });
      document.getElementById("banner-date").textContent = s;
    }
    updateBannerDate();
    setInterval(updateBannerDate, 15000);

    //?? Weather Bar ??
    var weatherCities = [
      { zip:"95648", city:"Lincoln, CA", wu:"https://www.wunderground.com/weather/us/ca/lincoln/95648" },
      { zip:"84664", city:"Mapleton, UT", wu:"https://www.wunderground.com/weather/us/ut/mapleton/84664" }
    ];
    function iconSvg(icon) {
      var m = {
        "01d":"day-sunny","01n":"night-clear",
        "02d":"day-cloudy","02n":"night-alt-cloudy",
        "03d":"cloudy","03n":"cloudy",
        "04d":"cloudy","04n":"cloudy",
        "09d":"showers","09n":"showers",
        "10d":"rain","10n":"rain",
        "11d":"thunderstorm","11n":"thunderstorm",
        "13d":"snow","13n":"snow",
        "50d":"fog","50n":"fog"
      };
      var f = m[icon]||"cloudy";
      return '<img src="animated/'+f+'.svg" width="33" height="33" style="vertical-align:middle;filter:drop-shadow(0 2px 6px #0003);">';
    }
    function renderWeatherBar(city, w, f) {
      var main = Math.round(w.main.temp)+"?F",
          hi   = Math.round(w.main.temp_max)+"?",
          lo   = Math.round(w.main.temp_min)+"?",
          desc = w.weather[0].main,
          icon = w.weather[0].icon,
          fcHtml = "";
      if (f && f.length) {
        fcHtml = '<div class="weather-bar-forecast">'+f.map(function(pt){
          var dt = new Date(pt.dt_txt),
              day=dt.toLocaleString("en-US",{weekday:"short"}),
              file=(iconSvg(pt.weather[0].icon).match(/animated\/([^\.]+)\./)||[])[1]||"cloudy";
          return '<div class="weather-bar-fc">'+
                 '<div class="weather-bar-fc-day">'+day+'</div>'+
                 '<img src="animated/'+file+'.svg" width="21" height="21">'+
                 '<div class="weather-bar-fc-desc">'+pt.weather[0].main+'</div>'+
                 '<span class="weather-bar-hi">'+Math.round(pt.main.temp_max)+'?</span>'+
                 '<span class="weather-bar-lo">'+Math.round(pt.main.temp_min)+'?</span>'+
                 '</div>';
        }).join("")+'</div>';
      }
      return '<div class="weather-bar-city" onclick="window.open(''+city.wu+'','_blank')">'+
             '<div class="weather-bar-cityname">'+city.city+'</div>'+iconSvg(icon)+
             '<span class="weather-bar-main">'+main+'</span>'+
             '<span class="weather-bar-desc">'+desc+'</span><br>'+
             '<span class="weather-bar-hi">H: '+hi+'</span>'+
             '<span class="weather-bar-lo">L: '+lo+'</span>'+fcHtml+
             '</div>';
    }
    function getForecastParts(forecast) {
      var res=[], seen={};
      forecast.list.forEach(function(item){
        var d=new Date(item.dt_txt);
        if (d.getHours()===12 && !seen[d.getDate()]) {
          res.push(item);
          seen[d.getDate()]=true;
        }
      });
      return res.slice(0,3);
    }
    function updateWeatherBar() {
      var bar = document.getElementById("weather-bar");
      bar.innerHTML = "Loading weather?";
      Promise.all(weatherCities.map(function(c){
        var base="https://api.openweathermap.org/data/2.5";
        var wURL=base+"/weather?zip="+c.zip+"&appid="+OWM_API_KEY+"&units=imperial";
        var fURL=base+"/forecast?zip="+c.zip+"&appid="+OWM_API_KEY+"&units=imperial";
        return Promise.all([wURL,fURL].map(function(url){
          return fetch(url).then(function(r){
            if (!r.ok) throw new Error("HTTP "+r.status+" for "+url);
            return r.json();
          });
        }));
      }))
      .then(function(all){
        bar.innerHTML = all.map(function(pair,i){
          return renderWeatherBar(weatherCities[i], pair[0], getForecastParts(pair[1]));
        }).join("");
      })
      .catch(function(err){
        console.error("Weather error:", err);
        bar.innerHTML = "<span style='color:#f44;'>Weather unavailable</span>";
      });
    }
    document.addEventListener("DOMContentLoaded", updateWeatherBar);

    //?? Calendar Agenda ??
    var GCAL_ID     = "support@perdigon-group.com";
    var GCAL_API_KEY= "AIzaSyDqMNGC5RUnlzSxP3vbD8WKzt_qPfUzab0";
    function fetchCalendarAgenda() {
      var widget = document.getElementById("agenda-widget"),
          now    = new Date(),
          tmMin  = new Date(now.getFullYear(),now.getMonth(),now.getDate()).toISOString(),
          tmMax  = new Date(now.getFullYear(),now.getMonth(),now.getDate()+2).toISOString(),
          url    = "https://www.googleapis.com/calendar/v3/calendars/"
                 + encodeURIComponent(GCAL_ID)
                 + "/events?key="+GCAL_API_KEY
                 + "&singleEvents=true&orderBy=startTime"
                 + "&timeMin="+encodeURIComponent(tmMin)
                 + "&timeMax="+encodeURIComponent(tmMax)
                 + "&maxResults=20";
      fetch(url).then(function(r){
        if(!r.ok) throw new Error("HTTP "+r.status+" Calendar");
        return r.json();
      }).then(function(data){
        var Agenda={today:[],tomorrow:[]},
            todayStr = tmMin.slice(0,10),
            tomDt = new Date(now); tomDt.setDate(now.getDate()+1);
        var tomStr = tomDt.toISOString().slice(0,10);
        (data.items||[]).forEach(function(ev){
          var s = ev.start.dateTime||ev.start.date;
          if(!s) return;
          var date = s.slice(0,10),
              grp  = date===todayStr ? "today" : date===tomStr ? "tomorrow" : null;
          if(!grp) return;
          var t = ev.start.dateTime
                ? new Date(ev.start.dateTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})
                : "",
              j = (ev.description&&ev.description.match(/https?://[^s<]+/))?
                  ev.description.match(/https?://[^s<]+/)[0]:"";
          Agenda[grp].push({title:ev.summary||"",time:t,join:j});
        });
        widget.innerHTML = ["today","tomorrow"].map(function(day){
          var L = Agenda[day];
          return '<div class="agenda-day" onclick="toggleAgenda(''+day+'')"><strong>'
               + day.charAt(0).toUpperCase()+day.slice(1)
               + '</strong></div>'
               + '<div class="agenda-list" id="agenda-'+day+'" style="display:none;">'
               + (L.length
                   ? L.map(function(e){
                       return '<div class="agenda-event"><span class="agenda-time">'+e.time+'</span>'
                            + '<span class="agenda-title">'+e.title+'</span>'
                            + (e.join?'<a href="'+e.join+'" target="_blank" class="agenda-join">Join Meeting</a>':"")
                            + '</div>';
                     }).join("")
                   : "<div class='agenda-empty'>No events</div>")
               + '</div>';
        }).join("");
      })
      .catch(function(err){
        console.error("Calendar error:",err);
        widget.innerHTML = "<div style='color:#f44;'>Calendar unavailable</div>";
      });
    }
    document.addEventListener("DOMContentLoaded", fetchCalendarAgenda);
    function toggleAgenda(day){
      var e = document.getElementById("agenda-"+day);
      e.style.display = e.style.display==="none"?"block":"none";
    }

    //?? Directory Filter ??
    function filterDirectory() {
      var filt = document.getElementById("directory-search").value.toLowerCase();
      document.querySelectorAll("#directory-table tr.contact-row").forEach(function(r){
        r.style.display = r.textContent.toLowerCase().includes(filt)?"":"none";
      });
      document.querySelectorAll("#directory-table tr.dept-header-row").forEach(function(h){
        var anyVis=false, nxt=h.nextElementSibling;
        while(nxt && !nxt.classList.contains("dept-header-row")){
          if(nxt.classList.contains("contact-row") && nxt.style.display!=="none"){
            anyVis=true; break;
          }
          nxt=nxt.nextElementSibling;
        }
        h.style.display = anyVis?"":"none";
        var sp = h.nextElementSibling;
        if(sp && sp.classList.contains("dept-space")){
          sp.style.display = anyVis?"":"none";
        }
      });
    }
  </script>
</body>
</html>