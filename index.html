<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>
   Perdigon Directory
  </title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat&amp;display=swap" rel="stylesheet"/>
<style>
   body { font-family: Montserrat, Arial, sans-serif; background: #23272e; color: #f3f3fa; margin: 0; }
    .banner { background: #181a1f; padding: 10px; display: flex; align-items: center; }
    .banner-logo { height:40px; border-radius:8px; margin-right:10px; }
    .searchbar input { width:100%; padding:8px; border-radius:4px; border:none; margin-bottom:10px; }
    .main-container { display:flex; padding:20px; gap:20px; }
    .directory-container { width:66%; }
    .sidebar-container { width:34%; }
    table { width:100%; border-collapse:collapse; background:#292e36; border-radius:8px; overflow:hidden; }
    th, td { padding:10px; border-bottom:1px solid #444; }
    th { background:#222844; }
    tr:hover { background:#2e3240; }
    td.number a { color:#4fb8ff; font-weight:700; text-decoration:none; }
    td.email { text-align:center; width:60px; }
    .envelope-icon { width:20px; vertical-align:middle; }
    .quicklinks { background:#292e36; border-radius:8px; padding:10px; margin-bottom:15px; }
    .quicklinks a {
      display:block; padding:10px; margin-bottom:8px; color:#fff;
      border-radius:6px; text-decoration:none; text-align:center;
    }
    .webex { background:#7c3aed; }
    .ticket { background:#22c55e; }
    .company { background:#eab308; }
    .tac { background:#0ea5e9; }
    .helpdesk { background:#f97316; }
    .kb { background:#14b8a6; }
    .footer { text-align:center; padding:20px; color:#aaa; }
  
.agenda-join {
  margin-left: 12px;
  background: #25d366;
  color: #fff;
  padding: 6px 14px;
  border-radius: 6px;
  text-decoration: none;
  font-size: .95em;
  font-weight: 700;
  display: inline-block;
}
.agenda-join:hover {
  background: #1cae58;
  color: #fff;
}

</style>
<style>
    body {
      background: #23272e;
      font-family: Montserrat, sans-serif;
      color: #f3f3fa;
      padding: 20px;
    }
    a.calendar-link {
      font-size: 0.9em;
      color: #7ad0ff;
      text-decoration: underline;
    }
    .agenda-widget {
      background: #292e36;
      border-radius: 12px;
      padding: 18px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 2px 10px #0002;
    }
    .agenda-section-title {
      font-size: 1.4em;
      color: #ffe066;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .agenda-day {
      background: #23272e;
      color: #ffd900;
      padding: 8px 14px;
      font-size: 1.1em;
      border-bottom: 1px solid #323650;
      cursor: pointer;
    }
    .agenda-list {
      padding: 8px 14px 14px 18px;
    }
    .agenda-event {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px 0;
    }
    .agenda-time {
      font-weight: bold;
      color: #4f46e5;
      width: 72px;
    }
    .agenda-title {
      flex-grow: 1;
    }
    .agenda-join {
      margin-left: 8px;
      background: #25d366;
      color: #fff;
      padding: 6px 14px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 700;
      font-size: .95em;
    }
    .agenda-empty {
      color: #aaa;
      padding: 12px 0;
    }
  </style></head>
<body>
<div class="banner">
<img class="banner-logo" src="https://mallen012.github.io/Perdigon-Directory/Blue%20Logo.png"/>
<h2>
    Perdigon Directory
   </h2>
<div id="banner-date" style="margin-left:auto;">
</div>
</div>
<div class="main-container">
<div class="directory-container">
<div class="searchbar">
<input id="search" oninput="filterTable()" placeholder="Search directory..." type="text"/>
</div>
<table id="directory-table">
<thead>
<tr>
<th>
        Name
       </th>
<th>
        Department
       </th>
<th>
        Number
       </th>
<th>
        Email
       </th>
<th>
        Notes
       </th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div class="sidebar-container">
<div class="support-calendar-container" style="background:#23272e;padding:18px;border-radius:12px;margin-bottom:28px;box-shadow:0 2px 10px #0003;"><div class="agenda-widget">
<div class="agenda-section-title">Support Calendar</div>
<div style="margin-bottom: 10px;">
<a class="calendar-link" href="https://calendar.google.com/calendar/u/0/r?cid=support@perdigon-group.com" target="_blank">
    support@perdigon-group.com
  </a>
</div>
<div class="agenda-day" onclick="toggleAgenda('today')"><strong>Today (click to minimize)</strong></div>
<div class="agenda-list" id="agenda-today" style="display:block;"></div>
<div class="agenda-day" onclick="toggleAgenda('tomorrow')"><strong>Tomorrow (click to minimize)</strong></div>
<div class="agenda-list" id="agenda-tomorrow" style="display:block;"></div>
</div></div>
<div class="quicklinks">
<a class="webex" href="https://perdigon.webex.com" target="_blank">
      Perdi Webex Site
     </a>
<a class="ticket" href="https://support.perdigon-group.com" target="_blank">
      Perdi Submit Ticket
     </a>
<a class="company" href="https://perdigon-group.com" target="_blank">
      Perdigon Website
     </a>
<a class="tac" href="https://mycase.cloudapps.cisco.com/start" target="_blank">
      Open TAC Case
     </a>
<a class="helpdesk" href="https://help.webex.com/en-us/contact" target="_blank">
      Webex HelpDesk
     </a>
<a class="kb" href="https://help.webex.com/en-us/result?offset=10&amp;tab=support" target="_blank">
      Webex KB
     </a>
</div>
</div>
</div>
<div class="footer">
   Generated by Perdigon | ? Mike Allen
   <a href="mailto:mike.allen@perdigon-group.com" target="_blank">
<img src="animated/envelope.svg" style="width:18px;height:18px;margin-left:6px;vertical-align:middle;"/>
</a>
</div>
<script>
  function updateClock() {
    document.getElementById('banner-date').textContent = new Date().toLocaleString();
  }
  setInterval(updateClock, 15000);
  updateClock();

  function filterTable() {
    let term = document.getElementById('search').value.toLowerCase();
    document.querySelectorAll("#directory-table tbody tr").forEach(row => {
      row.style.display = row.textContent.toLowerCase().includes(term) ? "" : "none";
    });
  }
</script>
<script>
  const GCAL_ID = "support@perdigon-group.com";
  const API_KEY = "AIzaSyDqMNGC5RUnlzSxP3vbD8WKzt_qPfUzab0";
  const TIMEZONE = "America/Los_Angeles";

  function fetchAndRenderAgenda() {
    const now = new Date();
    const end = new Date(); end.setDate(now.getDate() + 2);

    const isoNoMs = dt => dt.toISOString().split(".")[0] + "Z";
    const targetUrl = `https:
    const url = `https:

    fetch(url).then(r => r.json()).then(data => {
      if (!data.items) {
        document.getElementById("agenda-today").innerHTML = "<div class='agenda-empty'>No events found.</div>";
        return;
      }

      const tz = TIMEZONE;
      const todayStr = new Date().toLocaleDateString("en-US", { timeZone: tz });
      const tomorrow = new Date(); tomorrow.setDate(tomorrow.getDate() + 1);
      const tomorrowStr = tomorrow.toLocaleDateString("en-US", { timeZone: tz });

      const todayList = [], tomorrowList = [];

      data.items.forEach(ev => {
        const evDate = new Date(ev.start.dateTime || ev.start.date);
        const evDateStr = evDate.toLocaleDateString("en-US", { timeZone: tz });
        const group = evDateStr === todayStr ? "today" : evDateStr === tomorrowStr ? "tomorrow" : null;
        if (!group) return;

        const time = ev.start.dateTime ? new Date(ev.start.dateTime).toLocaleTimeString("en-US", { hour: "2-digit", minute: "2-digit", timeZone: tz }) : "All Day";
        let join = "";
        if (ev.description) {
          const match = ev.description.match(/https:\/\/[^\s<\n]+/);
          if (match) join = match[0].trim();
        }

        const obj = { time, title: ev.summary || "(No Title)", join };
        (group === "today" ? todayList : tomorrowList).push(obj);
      });

      renderAgendaList("today", todayList);
      renderAgendaList("tomorrow", tomorrowList);
    }).catch(err => {
      console.error("Calendar fetch failed:", err);
    });
  }

  function renderAgendaList(day, list) {
    const container = document.getElementById(`agenda-${day}`);
    if (!list.length) {
      container.innerHTML = "<div class='agenda-empty'>No events</div>";
      return;
    }
    container.innerHTML = list.map(item => `
      <div class="agenda-event">
        <span class="agenda-time">${item.time}</span>
        <span class="agenda-title">${item.title}</span>
        ${item.join ? `<a href="${item.join}" class="agenda-join" target="_blank">Join Meeting</a>` : ""}
      </div>
    `).join("");
  }

  function toggleAgenda(day) {
    const el = document.getElementById(`agenda-${day}`);
    const isHidden = el.style.display === "none";
    el.style.display = isHidden ? "block" : "none";
    const heading = document.querySelector(`.agenda-day[onclick*="${day}"] strong`);
    heading.textContent = isHidden ? `${capitalize(day)} (click to minimize)` : capitalize(day);
  }

  function capitalize(s) { return s.charAt(0).toUpperCase() + s.slice(1); }

  document.addEventListener("DOMContentLoaded", fetchAndRenderAgenda);
</script>
</body>
</html>